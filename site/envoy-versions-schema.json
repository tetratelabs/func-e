{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "id": "https://www.getenvoy.io/envoyVersions",
  "type": "object",
  "title": "EnvoyVersions",
  "description": "EnvoyVersions include metadata about the latest version and all available tarball URLs",
  "properties": {
    "latestVersion": {
      "title": "LatestVersion",
      "description": "LatestVersion is the latest stable version. See https://github.com/envoyproxy/envoy/blob/main/RELEASES.md",
      "type": "string",
      "pattern": "^[1-9][0-9]*\\.[0-9]+\\.[0-9]+$"
    },
    "versions": {
      "type": "object",
      "title": "Versions",
      "description": "Versions are all stable versions of Envoy keyed on version number (without a 'v' prefix)",
      "minProperties": 1,
      "propertyNames": {
        "pattern": "^[1-9][0-9]*\\.[0-9]+\\.[0-9]+$"
      },
      "additionalProperties": {
        "$ref": "#/definitions/EnvoyVersion"
      }
    }
  },
  "examples": [
    {
      "latestVersion": "1.18.3",
      "versions": {
        "1.14.6": {
          "releaseDate": "2021-04-16",
          "tarballs": {
            "darwin/amd64": "https://getenvoy.io/versions/1.14.6/envoy-1.14.6-darwin-x86_64.tar.gz",
            "linux/amd64": "https://getenvoy.io/versions/1.14.6/envoy-1.14.6-linux-x86_64.tar.gz"
          }
        },
        "1.18.3": {
          "releaseDate": "2021-05-11",
          "tarballs": {
            "darwin/amd64": "https://getenvoy.io/versions/1.18.3/envoy-1.18.3-darwin-x86_64.tar.gz",
            "linux/amd64": "https://getenvoy.io/versions/1.18.3/envoy-1.18.3-linux-x86_64.tar.gz",
          }
        }
      }
    }
  ],
  "definitions": {
    "EnvoyVersion": {
      "type": "object",
      "title": "EnvoyVersion",
      "description" : "EnvoyVersion is the release date and tarballs for this version, keyed on platform",
      "properties": {
        "releaseDate": {
          "title": "ReleaseDate",
          "description": "ReleaseDate is the date of the version tag https://github.com/envoyproxy/envoy/versions",
          "type": "string",
          "format": "date"
        },
        "tarballs": {
          "title": "Tarballs",
          "description": "Tarballs available by platform",
          "type": "object",
          "minProperties": 1,
          "propertyNames": {
            "$ref": "#/definitions/Platform"
          },
          "additionalProperties": {
            "$ref": "#/definitions/TarballURL"
          },
          "minItems": 1
        }
      },
      "required": [
        "releaseDate",
        "downloads"
      ]
    },
    "Platform": {
      "title": "Platform",
      "description": "'$os/$arch' where $os is the supported operating system (runtime.GOOS) and $arch is the supported architecture (runtime.GOARCH)",
      "type": "string",
      "examples": [
        "darwin/amd64",
        "linux/amd64",
        "linux/arm64"
      ]
    },
    "TarballURL": {
      "title": "Tarball URL",
      "description": "URL of the tar.gz or tar.xz that bundles Envoy. Minimum contents are $version/bin/envoy",
      "type": "string",
      "format": "uri"
    }
  }
}
